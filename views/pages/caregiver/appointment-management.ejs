<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Appointment Management - Caregiver Portal</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #136179cc;
        --primary-light: #eef2ff;
        --info: #36b9cc;
        --info-light: #e3f8fb;
        --success: #1cc88a;
        --success-light: #e6fff7;
        --warning: #f6c23e;
        --warning-light: #fff8e6;
        --danger: #e74a3b;
        --danger-light: #ffe6e4;
        --gray: #858796;
        --gray-light: #f8f9fc;
        --dark: #5a5c69;
        --sidebar-width: 250px;
        --transition-speed: 0.3s;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: #4ca4becc;
        color: #333;
        min-height: 100vh;
      }

      /* Background Elements */
      .background-container {
        position: fixed;
        width: 100%;
        height: 100%;
        overflow: hidden;
        z-index: -1;
      }

      .shape {
        position: absolute;
        opacity: 0.05;
        border-radius: 50%;
      }

      .shape1 {
        width: 500px;
        height: 500px;
        background: var(--primary);
        top: -150px;
        right: -100px;
      }

      .shape2 {
        width: 300px;
        height: 300px;
        background: var(--info);
        bottom: -100px;
        left: -50px;
      }

      .icons-container {
        position: absolute;
        width: 100%;
        height: 100%;
      }

      .icon {
        position: absolute;
        color: var(--gray);
        opacity: 0.05;
        font-size: 40px;
      }

      .icon:nth-child(1) {
        top: 20%;
        left: 10%;
      }
      .icon:nth-child(2) {
        top: 40%;
        left: 25%;
      }
      .icon:nth-child(3) {
        top: 60%;
        left: 15%;
      }
      .icon:nth-child(4) {
        top: 80%;
        left: 30%;
      }
      .icon:nth-child(5) {
        top: 15%;
        right: 20%;
      }
      .icon:nth-child(6) {
        top: 35%;
        right: 10%;
      }
      .icon:nth-child(7) {
        top: 55%;
        right: 25%;
      }
      .icon:nth-child(8) {
        top: 75%;
        right: 15%;
      }

      /* Sidebar */
      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        width: var(--sidebar-width);
        height: 100%;
        background: #167997cc;
        box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
        z-index: 100;
        transition: all var(--transition-speed);
        overflow-y: auto;
      }

      .sidebar h2 {
        padding: 1.5rem;
        color: white;
        font-size: 1.2rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .sidebar ul {
        list-style: none;
        padding: 1rem 0;
      }

      .sidebar ul li {
        position: relative;
      }

      .sidebar ul li a {
        display: flex;
        align-items: center;
        color: white;
        padding: 0.8rem 1.5rem;
        text-decoration: none;
        transition: all 0.2s;
      }

      .sidebar ul li a i {
        margin-right: 0.8rem;
        min-width: 20px;
        text-align: center;
      }

      .sidebar ul li.active a,
      .sidebar ul li a:hover {
        color: var(--primary);
        background: var(--primary-light);
        border-left: 4px solid var(--primary);
      }

      /* Main Content */
      .main-content {
        margin-left: var(--sidebar-width);
        padding: 1.5rem;
        transition: all var(--transition-speed);
      }

      /* Header */
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .header h1 {
        font-size: 1.7rem;
        color: var(--dark);
        font-weight: 500;
      }

      .user-profile {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .profile-image {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
      }

      .notification-bell {
        position: relative;
        cursor: pointer;
      }

      .notification-count {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: var(--danger);
        color: white;
        font-size: 12px;
        padding: 2px 6px;
        border-radius: 50%;
      }

      /* Cards and tables */
      .card {
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1);
        margin-bottom: 1.5rem;
        border: none;
      }

      .card-header {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        background-color: white;
        border-top-left-radius: 12px !important;
        border-top-right-radius: 12px !important;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .card-title {
        margin-bottom: 0;
        color: var(--dark);
        font-weight: 500;
      }

      /* Menu Toggle */
      .menu-toggle {
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 200;
        background: var(--primary);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        display: none;
      }

      /* Appointments Filter Bar */
      .appointments-filter-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 10px;
      }

      .filter-section {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .filter-group {
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .filter-select {
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        font-size: 14px;
      }

      .action-section {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .btn-primary {
        background-color: var(--primary);
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-weight: 500;
        transition: var(--transition-speed);
      }

      .btn-primary:hover {
        background-color: var(--secondary);
      }

      /* Search Bar */
      .search-bar {
        margin-bottom: 20px;
      }

      .search-input-container {
        position: relative;
      }

      .search-icon {
        position: absolute;
        top: 50%;
        left: 10px;
        transform: translateY(-50%);
        color: var(--gray);
      }

      .search-input {
        width: 100%;
        padding: 10px 10px 10px 35px;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        font-size: 14px;
      }

      /* Appointment Stats */
      .appointment-stats {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 20px;
      }

      @media (max-width: 992px) {
        .appointment-stats {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 576px) {
        .appointment-stats {
          grid-template-columns: 1fr;
        }
      }

      .stat-card {
        background-color: white;
        border-radius: var(--border-radius);
        padding: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: var(--box-shadow);
      }

      .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }

      .stat-details {
        flex: 1;
      }

      .stat-details h4 {
        margin: 0;
        font-size: 14px;
        color: var(--gray);
      }

      .stat-count {
        font-size: 24px;
        font-weight: 600;
      }

      /* Status Badges */
      .status-badge {
        padding: 5px 10px;
        border-radius: var(--border-radius);
        font-size: 12px;
        font-weight: 500;
      }

      .status-badge.scheduled {
        background-color: var(--success);
        color: white;
      }

      .status-badge.pending {
        background-color: var(--warning);
        color: white;
      }

      .status-badge.completed {
        background-color: var(--info);
        color: white;
      }

      .status-badge.cancelled {
        background-color: var(--danger);
        color: white;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.active {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
        }

        .menu-toggle {
          display: flex;
        }

        .filter-section,
        .action-section {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <!-- Background Elements -->
    <div class="background-container">
      <div class="shape shape1"></div>
      <div class="shape shape2"></div>
      <div class="icons-container">
        <i class="icon fas fa-heartbeat"></i>
        <i class="icon fas fa-pills"></i>
        <i class="icon fas fa-stethoscope"></i>
        <i class="icon fas fa-user-md"></i>
        <i class="icon fas fa-hospital"></i>
        <i class="icon fas fa-notes-medical"></i>
        <i class="icon fas fa-syringe"></i>
        <i class="icon fas fa-ambulance"></i>
      </div>
    </div>

    <!-- Menu Toggle for Mobile -->
    <div class="menu-toggle" id="menuToggle">
      <i class="fas fa-bars"></i>
    </div>

    <div class="sidebar" id="sidebar">
      <h2><i class="fas fa-user-md"></i> Caregiver Portal</h2>
      <ul>
        <li>
          <a href="/caregiver/dashboard"
            ><i class="fas fa-home"></i> Dashboard</a
          >
        </li>
        <li class="active">
          <a href="/caregiver/appointments"
            ><i class="fas fa-calendar-check"></i> Appointments</a
          >
        </li>
        <li>
          <a href="/caregiver/patient-requests"
            ><i class="fas fa-user-plus"></i> Patient Requests</a
          >
        </li>
        <li>
          <a href="/caregiver/profile"
            ><i class="fas fa-user-md"></i> Profile</a
          >
        </li>
      </ul>
      <ul class="logout">
        <li>
          <a href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="header">
        <h1>Appointments Management</h1>
        <div class="user-profile">
          <div class="notification-bell" id="notificationBell">
            <i class="fas fa-bell"></i>
            <span class="notification-count">5</span>
          </div>
        </div>
      </div>

      <!-- Appointment Stats -->
      <div class="appointment-stats">
        <div class="stat-card">
          <div class="stat-icon bg-primary">
            <i class="fas fa-calendar-check"></i>
          </div>
          <div class="stat-details">
            <h4>Today</h4>
            <div class="stat-count">
              <%= typeof todayAppointments !== 'undefined' ? todayAppointments :
              6 %>
            </div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-info">
            <i class="fas fa-calendar-plus"></i>
          </div>
          <div class="stat-details">
            <h4>Upcoming</h4>
            <div class="stat-count">
              <%= typeof upcomingAppointments !== 'undefined' ?
              upcomingAppointments : 14 %>
            </div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-success">
            <i class="fas fa-check-circle"></i>
          </div>
          <div class="stat-details">
            <h4>Completed</h4>
            <div class="stat-count">
              <%= typeof completedAppointments !== 'undefined' ?
              completedAppointments : 8 %>
            </div>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon bg-warning">
            <i class="fas fa-clock"></i>
          </div>
          <div class="stat-details">
            <h4>Pending</h4>
            <div class="stat-count">
              <%= typeof pendingRequests !== 'undefined' ? pendingRequests : 5
              %>
            </div>
          </div>
        </div>
      </div>

      <!-- Filter and Action Bar -->
      <div class="card">
        <div class="card-header">
          <h5 class="card-title">
            <i class="fas fa-filter me-2"></i> Filter Options
          </h5>
        </div>
        <div class="card-body">
          <div class="appointments-filter-bar">
            <div class="filter-section">
              <div class="filter-group">
                <label for="dateFilter">Date Range:</label>
                <select id="dateFilter" class="filter-select">
                  <option value="today">Today</option>
                  <option value="tomorrow">Tomorrow</option>
                  <option value="week" selected>This Week</option>
                  <option value="month">This Month</option>
                  <option value="custom">Custom Range</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="urgencyFilter">Urgency:</label>
                <select id="urgencyFilter" class="filter-select">
                  <option value="all" selected>All</option>
                  <option value="urgent">Urgent</option>
                  <option value="regular">Regular</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="typeFilter">Type:</label>
                <select id="typeFilter" class="filter-select">
                  <option value="all" selected>All Types</option>
                  <option value="checkup">Regular Checkup</option>
                  <option value="followup">Follow-up</option>
                  <option value="consultation">Consultation</option>
                  <option value="prescription">Prescription Review</option>
                </select>
              </div>

              <div class="filter-group">
                <label for="statusFilter">Status:</label>
                <select id="statusFilter" class="filter-select">
                  <option value="all" selected>All Status</option>
                  <option value="scheduled">Scheduled</option>
                  <option value="pending">Pending</option>
                  <option value="completed">Completed</option>
                  <option value="cancelled">Cancelled</option>
                </select>
              </div>
            </div>

            <div class="action-section">
              <button class="btn btn-primary" id="newAppointmentBtn">
                <i class="fas fa-plus"></i> New Appointment
              </button>
              <div class="btn-group">
                <button
                  class="btn btn-outline-secondary active"
                  id="listViewBtn"
                >
                  <i class="fas fa-list"></i>
                </button>
                <button class="btn btn-outline-secondary" id="calendarViewBtn">
                  <i class="fas fa-calendar-alt"></i>
                </button>
              </div>
            </div>
          </div>

          <!-- Search Bar -->
          <div class="search-bar">
            <div class="search-input-container">
              <i class="fas fa-search search-icon"></i>
              <input
                type="text"
                id="appointmentSearch"
                class="search-input"
                placeholder="Search by patient name, ID, or appointment details..."
              />
            </div>
          </div>
        </div>
      </div>

      <!-- Appointments List -->
      <div class="card" id="listView">
        <div class="card-header">
          <h5 class="card-title">
            <i class="fas fa-calendar-alt me-2"></i> Upcoming Appointments
          </h5>
          <div class="dropdown">
            <button
              class="btn btn-sm btn-outline-primary dropdown-toggle"
              type="button"
              id="exportBtn"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <i class="fas fa-download me-1"></i> Export
            </button>
            <ul
              class="dropdown-menu dropdown-menu-end"
              aria-labelledby="exportBtn"
            >
              <li>
                <button class="dropdown-item" id="exportCSV">
                  <i class="fas fa-file-csv me-2"></i>Export as CSV
                </button>
              </li>
              <li>
                <button class="dropdown-item" id="exportPDF">
                  <i class="fas fa-file-pdf me-2"></i>Export as PDF
                </button>
              </li>
              <li>
                <button class="dropdown-item" id="exportPrint">
                  <i class="fas fa-print me-2"></i>Print
                </button>
              </li>
            </ul>
          </div>
        </div>

        <div class="card-body p-0">
          <div class="p-3 bg-light border-bottom">
            <strong
              >Today, <%= new Date().toLocaleDateString('en-US', {weekday:
              'long', month: 'long', day: 'numeric', year: 'numeric'})
              %></strong
            >
          </div>

          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <thead>
                <tr>
                  <th>Time</th>
                  <th>Patient</th>
                  <th>Type</th>
                  <th>Status</th>
                  <th class="text-center">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <div class="fw-medium">09:00 AM</div>
                    <small class="text-muted">30 min</small>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="avatar me-3">
                        <i class="fas fa-user"></i>
                      </div>
                      <div>
                        <div class="fw-medium">John Doe</div>
                        <small class="text-muted">42y, Male • ID: P-1024</small>
                      </div>
                    </div>
                  </td>
                  <td>Regular Checkup</td>
                  <td><span class="status-badge scheduled">Scheduled</span></td>
                  <td class="text-center">
                    <button
                      class="btn btn-sm btn-success"
                      title="Start Meeting"
                    >
                      <i class="fas fa-video"></i>
                    </button>
                    <button
                      class="btn btn-sm btn-info view-details-btn"
                      data-bs-toggle="modal"
                      data-bs-target="#appointmentDetailsModal"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-warning">
                      <i class="fas fa-clock"></i>
                    </button>
                    <button class="btn btn-sm btn-danger">
                      <i class="fas fa-times"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="fw-medium">10:30 AM</div>
                    <small class="text-muted">45 min</small>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="avatar me-3">
                        <i class="fas fa-user"></i>
                      </div>
                      <div>
                        <div class="fw-medium">Maria Garcia</div>
                        <small class="text-muted"
                          >35y, Female • ID: P-2189</small
                        >
                      </div>
                    </div>
                  </td>
                  <td>Follow-up</td>
                  <td><span class="status-badge scheduled">Scheduled</span></td>
                  <td class="text-center">
                    <button
                      class="btn btn-sm btn-success"
                      title="Start Meeting"
                    >
                      <i class="fas fa-video"></i>
                    </button>
                    <button
                      class="btn btn-sm btn-info view-details-btn"
                      data-bs-toggle="modal"
                      data-bs-target="#appointmentDetailsModal"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-warning">
                      <i class="fas fa-clock"></i>
                    </button>
                    <button class="btn btn-sm btn-danger">
                      <i class="fas fa-times"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="fw-medium">01:15 PM</div>
                    <small class="text-muted">60 min</small>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="avatar me-3">
                        <i class="fas fa-user"></i>
                      </div>
                      <div>
                        <div class="fw-medium">Robert Smith</div>
                        <small class="text-muted">28y, Male • ID: P-3570</small>
                      </div>
                    </div>
                  </td>
                  <td>
                    Consultation <span class="badge bg-danger">Urgent</span>
                  </td>
                  <td><span class="status-badge pending">Pending</span></td>
                  <td class="text-center">
                    <button class="btn btn-sm btn-primary" title="Accept">
                      <i class="fas fa-check"></i>
                    </button>
                    <button
                      class="btn btn-sm btn-info view-details-btn"
                      data-bs-toggle="modal"
                      data-bs-target="#appointmentDetailsModal"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-warning">
                      <i class="fas fa-clock"></i>
                    </button>
                    <button class="btn btn-sm btn-danger">
                      <i class="fas fa-times"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="p-3 bg-light border-bottom">
            <strong
              >Tomorrow, <%= new Date(Date.now() +
              86400000).toLocaleDateString('en-US', {weekday: 'long', month:
              'long', day: 'numeric', year: 'numeric'}) %></strong
            >
          </div>

          <div class="table-responsive">
            <table class="table table-hover mb-0">
              <tbody>
                <tr>
                  <td>
                    <div class="fw-medium">08:30 AM</div>
                    <small class="text-muted">45 min</small>
                  </td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="avatar me-3">
                        <i class="fas fa-user"></i>
                      </div>
                      <div>
                        <div class="fw-medium">James Miller</div>
                        <small class="text-muted">39y, Male • ID: P-5172</small>
                      </div>
                    </div>
                  </td>
                  <td>Follow-up</td>
                  <td><span class="status-badge scheduled">Scheduled</span></td>
                  <td class="text-center">
                    <button
                      class="btn btn-sm btn-success"
                      title="Start Meeting"
                    >
                      <i class="fas fa-video"></i>
                    </button>
                    <button
                      class="btn btn-sm btn-info view-details-btn"
                      data-bs-toggle="modal"
                      data-bs-target="#appointmentDetailsModal"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-warning">
                      <i class="fas fa-clock"></i>
                    </button>
                    <button class="btn btn-sm btn-danger">
                      <i class="fas fa-times"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Calendar View (initially hidden) -->
      <div class="card" id="calendarView" style="display: none">
        <div class="card-header">
          <h5 class="card-title">
            <i class="fas fa-calendar-alt me-2"></i> Calendar View
          </h5>
        </div>
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <button class="btn btn-sm btn-outline-secondary" id="prevMonth">
              <i class="fas fa-chevron-left"></i>
            </button>
            <h4 id="currentMonthYear" class="mb-0">
              <%= new Date().toLocaleDateString('en-US', {month: 'long', year:
              'numeric'}) %>
            </h4>
            <button class="btn btn-sm btn-outline-secondary" id="nextMonth">
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
          <div class="calendar-grid mb-3">
            <!-- Calendar will be generated with JavaScript -->
            <div class="alert alert-info">
              <i class="fas fa-info-circle me-2"></i> Calendar view is under
              development. Please use list view for now.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Appointment Details Modal -->
    <div
      class="modal fade"
      id="appointmentDetailsModal"
      tabindex="-1"
      aria-labelledby="appointmentDetailsModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="appointmentDetailsModalLabel">
              Appointment Details
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-4">
              <div class="d-flex align-items-center mb-3">
                <div
                  class="avatar me-3"
                  style="width: 50px; height: 50px; font-size: 1.2rem"
                >
                  <i class="fas fa-user"></i>
                </div>
                <div>
                  <h5 class="mb-0">John Doe</h5>
                  <div class="text-muted">
                    42 years, Male • Patient ID: P-1024
                  </div>
                  <div class="mt-1">
                    <span class="badge bg-info">Regular Checkup</span>
                    <span class="status-badge scheduled">Scheduled</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="row g-3">
              <div class="col-md-6">
                <div class="card h-100">
                  <div class="card-header">
                    <h6 class="mb-0">
                      <i class="fas fa-calendar-alt me-2"></i> Appointment Info
                    </h6>
                  </div>
                  <div class="card-body">
                    <dl class="row mb-0">
                      <dt class="col-sm-4">Date:</dt>
                      <dd class="col-sm-8">March 23, 2023 (Today)</dd>

                      <dt class="col-sm-4">Time:</dt>
                      <dd class="col-sm-8">09:00 AM - 09:30 AM (30 minutes)</dd>

                      <dt class="col-sm-4">Type:</dt>
                      <dd class="col-sm-8">Regular Checkup</dd>

                      <dt class="col-sm-4">Reason:</dt>
                      <dd class="col-sm-8">
                        Annual wellness check and review of hypertension
                        medication
                      </dd>
                    </dl>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="card h-100">
                  <div class="card-header">
                    <h6 class="mb-0">
                      <i class="fas fa-file-medical me-2"></i> Patient History
                    </h6>
                  </div>
                  <div class="card-body">
                    <dl class="row mb-0">
                      <dt class="col-sm-4">Last Visit:</dt>
                      <dd class="col-sm-8">
                        September 15, 2022 (6 months ago)
                      </dd>

                      <dt class="col-sm-4">Conditions:</dt>
                      <dd class="col-sm-8">Hypertension, High Cholesterol</dd>

                      <dt class="col-sm-4">Medications:</dt>
                      <dd class="col-sm-8">
                        Lisinopril 10mg daily, Simvastatin 20mg daily
                      </dd>

                      <dt class="col-sm-4">Allergies:</dt>
                      <dd class="col-sm-8">Penicillin</dd>
                    </dl>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-warning">
              <i class="fas fa-clock me-1"></i> Reschedule
            </button>
            <button type="button" class="btn btn-danger">
              <i class="fas fa-times me-1"></i> Cancel Appointment
            </button>
            <button type="button" class="btn btn-success">
              <i class="fas fa-video me-1"></i> Start Session
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- New Appointment Modal -->
    <div
      class="modal fade"
      id="newAppointmentModal"
      tabindex="-1"
      aria-labelledby="newAppointmentModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="newAppointmentModalLabel">
              Schedule New Appointment
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="appointmentForm">
              <div class="mb-3">
                <label for="patientSelect" class="form-label"
                  >Select Patient</label
                >
                <select id="patientSelect" class="form-select" required>
                  <option value="" selected disabled>Choose a patient</option>
                  <option value="1">John Doe (P-1024)</option>
                  <option value="2">Maria Garcia (P-2189)</option>
                  <option value="3">Robert Smith (P-3570)</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="appointmentType" class="form-label"
                  >Appointment Type</label
                >
                <select id="appointmentType" class="form-select" required>
                  <option value="" selected disabled>Select type</option>
                  <option value="checkup">Regular Checkup</option>
                  <option value="followup">Follow-up</option>
                  <option value="consultation">Consultation</option>
                  <option value="prescription">Prescription Review</option>
                </select>
              </div>

              <div class="row g-3 mb-3">
                <div class="col-md-6">
                  <label for="appointmentDate" class="form-label">Date</label>
                  <input
                    type="date"
                    id="appointmentDate"
                    class="form-control"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="appointmentTime" class="form-label">Time</label>
                  <input
                    type="time"
                    id="appointmentTime"
                    class="form-control"
                    required
                  />
                </div>
              </div>

              <div class="mb-3">
                <label for="duration" class="form-label">Duration</label>
                <select id="duration" class="form-select" required>
                  <option value="15">15 minutes</option>
                  <option value="30" selected>30 minutes</option>
                  <option value="45">45 minutes</option>
                  <option value="60">60 minutes</option>
                </select>
              </div>

              <div class="mb-3">
                <label for="appointmentNotes" class="form-label">Notes</label>
                <textarea
                  id="appointmentNotes"
                  class="form-control"
                  rows="3"
                  placeholder="Add any notes or special instructions..."
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="saveAppointmentBtn"
            >
              Schedule Appointment
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Menu toggle for mobile
        const menuToggle = document.getElementById("menuToggle");
        const sidebar = document.getElementById("sidebar");

        if (menuToggle) {
          menuToggle.addEventListener("click", function () {
            sidebar.classList.toggle("active");
          });
        }

        // Toggle between list and calendar views
        const listViewBtn = document.getElementById("listViewBtn");
        const calendarViewBtn = document.getElementById("calendarViewBtn");
        const listView = document.getElementById("listView");
        const calendarView = document.getElementById("calendarView");

        listViewBtn.addEventListener("click", function () {
          listView.style.display = "block";
          calendarView.style.display = "none";
          listViewBtn.classList.add("active");
          calendarViewBtn.classList.remove("active");
        });

        calendarViewBtn.addEventListener("click", function () {
          listView.style.display = "none";
          calendarView.style.display = "block";
          listViewBtn.classList.remove("active");
          calendarViewBtn.classList.add("active");
        });

        // New appointment button
        const newAppointmentBtn = document.getElementById("newAppointmentBtn");
        newAppointmentBtn.addEventListener("click", function () {
          const newAppointmentModal = new bootstrap.Modal(
            document.getElementById("newAppointmentModal")
          );
          newAppointmentModal.show();
        });

        // Save appointment button
        const saveAppointmentBtn =
          document.getElementById("saveAppointmentBtn");
        saveAppointmentBtn.addEventListener("click", function () {
          // In a real implementation, you would validate and save the form data
          alert("Appointment scheduled successfully!");
          bootstrap.Modal.getInstance(
            document.getElementById("newAppointmentModal")
          ).hide();
        });

        // Export functionality
        document
          .getElementById("exportCSV")
          .addEventListener("click", function () {
            exportAppointmentsToCSV();
          });

        document
          .getElementById("exportPDF")
          .addEventListener("click", function () {
            alert("Export to PDF functionality will be available soon.");
          });

        document
          .getElementById("exportPrint")
          .addEventListener("click", function () {
            window.print();
          });

        // Function to export appointments as CSV
        function exportAppointmentsToCSV() {
          // Get table data
          const table = document.querySelector("#listView table");
          const rows = table.querySelectorAll("tbody tr");

          // Create CSV content
          let csvContent =
            "Time,Duration,Patient Name,Patient ID,Type,Status\n";

          rows.forEach((row) => {
            const cells = row.querySelectorAll("td");
            if (cells.length >= 5) {
              const time = cells[0]
                .querySelector(".fw-medium")
                .innerText.trim();
              const duration = cells[0].querySelector("small").innerText.trim();
              const patientName = cells[1]
                .querySelector(".fw-medium")
                .innerText.trim();
              const patientDetails = cells[1]
                .querySelector("small")
                .innerText.trim();
              const patientID = patientDetails.split("•")[1]?.trim() || "";
              const appointmentType = cells[2].innerText
                .trim()
                .replace(",", " -");
              const status = cells[3]
                .querySelector(".status-badge")
                .innerText.trim();

              csvContent += `"${time}","${duration}","${patientName}","${patientID}","${appointmentType}","${status}"\n`;
            }
          });

          // Create download link
          const encodedUri = encodeURI(
            "data:text/csv;charset=utf-8," + csvContent
          );
          const link = document.createElement("a");
          link.setAttribute("href", encodedUri);
          link.setAttribute(
            "download",
            "appointments_" + new Date().toISOString().split("T")[0] + ".csv"
          );
          document.body.appendChild(link);

          // Download the CSV file
          link.click();
          document.body.removeChild(link);
        }

        // Set minimum date for appointment date picker to today
        const appointmentDateInput = document.getElementById("appointmentDate");
        if (appointmentDateInput) {
          const today = new Date().toISOString().split("T")[0];
          appointmentDateInput.setAttribute("min", today);
          appointmentDateInput.value = today;
        }
      });
    </script>
  </body>
</html>
